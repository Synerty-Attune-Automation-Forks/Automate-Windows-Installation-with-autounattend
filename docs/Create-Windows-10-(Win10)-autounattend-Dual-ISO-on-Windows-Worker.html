
<!doctype html>
<html lang="en">




<head>
    <title>How to Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker - Attune Automation">
    <meta name="description"
          content="">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker - Attune Automation" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker - Attune Automation" />
    <meta name="twitter:description" content="" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    Automate Windows Installation with autounattend
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#checkinputparametervaluesforwin10kickstartonwindowsworker">
                            <strong>Step 1 -</strong> Check Input Parameter Values for Win10 Kickstart on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#checkmaximumlengthofwin10hostnameonwindowsworker">
                            <strong>Step 2 -</strong> Check Maximum Length of Win10 Hostname on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#checkifipaddressisinsubnetonwindowsworker">
                            <strong>Step 3 -</strong> Check if IP Address is in Subnet on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#checkifgatewayipaddressisinsubnetonwindowsworker">
                            <strong>Step 4 -</strong> Check if Gateway IP Address is in Subnet on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#verifywslisinstalled">
                            <strong>Step 5 -</strong> Verify WSL is Installed
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#cleanupbuildfilesandisosonwindowsworker">
                            <strong>Step 6 -</strong> Clean Up Build Files and ISOs on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploywin10dvdisoonwindowsworker">
                            <strong>Step 7 -</strong> Deploy Win10 DVD ISO on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#extractwindowsbootimgonwindowsworker">
                            <strong>Step 8 -</strong> Extract Windows boot.img on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#extractwindowsisoonwindowsworker">
                            <strong>Step 9 -</strong>  Extract Windows ISO on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#copyefisysnopromptbinintoefisysbinonwindowsworker">
                            <strong>Step 10 -</strong> Copy efisys_noprompt.bin into efisys.bin on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createbiosbootisoonwindowsworker">
                            <strong>Step 11 -</strong> Create BIOS Boot ISO on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createuefibootisoonwindowsworker">
                            <strong>Step 12 -</strong> Create UEFI Boot ISO on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploywindowsunattendedconfigonwindowsworker">
                            <strong>Step 13 -</strong> Deploy Windows Unattended Config on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploypostsetuppowershellscriptonwindowsworker">
                            <strong>Step 14 -</strong> Deploy Post Setup PowerShell Script on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#copydriversdropinfolderonwindowsworker">
                            <strong>Step 15 -</strong> Copy Drivers Drop in Folder on Windows Worker
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createanswerfileisoonwindowsworker">
                            <strong>Step 16 -</strong> Create Answer File ISO on Windows Worker
                        </a>
                    </p>


                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Create Windows 10 (Win10) autounattend Dual ISO on Windows Worker</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="checkinputparametervaluesforwin10kickstartonwindowsworker">
                            <a href="#checkinputparametervaluesforwin10kickstartonwindowsworker">
                                <strong>Step 1 -</strong> Check Input Parameter Values for Win10 Kickstart on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via RDP:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
mstsc /admin /v:{automationworkerwindowsnode}
                            </code>
                        </div>
                        <div class="row">
                            <p>
                                Login as user {automationworkerwindowsuseradministrator} and open a
                                command prompt.
                            </p>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if ((-Not ${{isWin10Bios}}) -and `
    (-Not ${{isWin10Uefi}})) {

    Write-Host &quot;Please set one of &#x27;isWin10Bios&#x27; or &#x27;isWin10Uefi&#x27; to true to install Win10.&quot;
    exit 1
} else {
    Write-Host &quot;Ok.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="checkmaximumlengthofwin10hostnameonwindowsworker">
                            <a href="#checkmaximumlengthofwin10hostnameonwindowsworker">
                                <strong>Step 2 -</strong> Check Maximum Length of Win10 Hostname on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if ( ${{isWin10Bios}} -or ${{isWin10Uefi}} ) {

    $HOSTNAME = &quot;{newOsNode.hostname}&quot;
    
    $LENGTH = $HOSTNAME.length
    $MAX_LENGTH = 15
    
    if ( $LENGTH -gt $MAX_LENGTH ) {
        Write-Host &quot;Length of hostname ${LENGTH} for Win10 can&#x27;t be more than ${MAX_LENGTH}.&quot;
        false
    } else {
        Write-Host &quot;Length of hostname ${LENGTH} is less than or equal to ${MAX_LENGTH}.&quot;
    }
    
} else {
    Write-Host &quot;Not Win10, skipping.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="checkifipaddressisinsubnetonwindowsworker">
                            <a href="#checkifipaddressisinsubnetonwindowsworker">
                                <strong>Step 3 -</strong> Check if IP Address is in Subnet on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <h4>To Debug</h4>
<ul>
<li>Uncomment out the <code>Write-Host</code>s to debug.</li>
</ul>
<h4>Logic</h4>
<ul>
<li>For loop loops through each octet in the IP address, subnet range octet and subnet mask.</li>
<li>For each octet:<ul>
<li>The min octet is the subnet octet bitwised <code>AND</code>ed with the netmask octet.</li>
<li>A wildcard octet is 255 - netmask octet.</li>
<li>The max octet is the subnet octet bitwised <code>OR</code>ed with the wildcard octet.</li>
<li>The IP address octet is tested to see if it is between the min and max octets.</li>
</ul>
</li>
</ul>
<h4>References</h4>
<p><a href="https://www.freecodecamp.org/news/subnet-cheat-sheet-24-subnet-mask-30-26-27-29-and-other-ip-address-cidr-network-references/">Subnet Cheat Sheet - 24 Subnet Mask, 30, 26, 27, 29, and other IP Address CIDR Network References</a></p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
Write-Host &quot;IP address={newOsNode.ip}&quot;
Write-Host &quot;subnet={newOsNodeSubnet.subnet}&quot;
Write-Host &quot;netmask={newOsNodeSubnet.netmask}&quot;
#Write-Host &quot;i, IP_OCTET, SUBNET_OCTET, NETMASK_OCTET, WILDCARD_MASK, OCTET_MIN, OCTET_MAX&quot;

$IP_OCTETS = &quot;{newOsNode.ip}&quot;.split(&#x27;.&#x27;)
$SUBNET_OCTETS = &quot;{newOsNodeSubnet.subnet}&quot;.split(&#x27;.&#x27;)
$NETMASK_OCTETS = &quot;{newOsNodeSubnet.netmask}&quot;.split(&#x27;.&#x27;)

for ($i = 0; $i -lt 4; $i++) {
    $IP_OCTET = $IP_OCTETS[$i]
    $SUBNET_OCTET = $SUBNET_OCTETS[$i]
    $NETMASK_OCTET = $NETMASK_OCTETS[$i]
    
    $OCTET_MIN = $SUBNET_OCTET -band $NETMASK_OCTET

    $WILDCARD_MASK = 255 - $NETMASK_OCTET
    $OCTET_MAX = $SUBNET_OCTET -bor $WILDCARD_MASK
    
    #Write-Host &quot;$i. $IP_OCTET, $SUBNET_OCTET, $NETMASK_OCTET, $WILDCARD_MASK, $OCTET_MIN, $OCTET_MAX&quot;
    
    if ( ($IP_OCTET -ge $OCTET_MIN) -and
        ($IP_OCTET -le $OCTET_MAX) ) {
        Write-Host &quot;Octet number $i, $OCTET_MIN &lt;= $IP_OCTET &lt;= $OCTET_MAX, ok.&quot;
    } else {
        Write-Host &quot;Octet number $i, $OCTET_MIN &lt;= $IP_OCTET &lt;= $OCTET_MAX is false. Not in range of the subnet mask.&quot;
        exit 1
    }
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="checkifgatewayipaddressisinsubnetonwindowsworker">
                            <a href="#checkifgatewayipaddressisinsubnetonwindowsworker">
                                <strong>Step 4 -</strong> Check if Gateway IP Address is in Subnet on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <h4>To Debug</h4>
<ul>
<li>Uncomment out the <code>Write-Host</code>s to debug.</li>
</ul>
<h4>Logic</h4>
<ul>
<li>For loop loops through each octet in the gateway IP address, subnet range octet and subnet mask.</li>
<li>For each octet:<ul>
<li>The min octet is the subnet octet bitwised <code>AND</code>ed with the netmask octet.</li>
<li>A wildcard octet is 255 - netmask octet.</li>
<li>The max octet is the subnet octet bitwised <code>OR</code>ed with the wildcard octet.</li>
<li>The gateway IP address octet is tested to see if it is between the min and max octets.</li>
</ul>
</li>
</ul>
<h4>References</h4>
<p><a href="https://www.freecodecamp.org/news/subnet-cheat-sheet-24-subnet-mask-30-26-27-29-and-other-ip-address-cidr-network-references/">Subnet Cheat Sheet - 24 Subnet Mask, 30, 26, 27, 29, and other IP Address CIDR Network References</a></p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
Write-Host &quot;gateway IP address={newOsNodeSubnet.gateway}&quot;
Write-Host &quot;subnet={newOsNodeSubnet.subnet}&quot;
Write-Host &quot;netmask={newOsNodeSubnet.netmask}&quot;
#Write-Host &quot;i, GATEWAY_OCTET, SUBNET_OCTET, NETMASK_OCTET, WILDCARD_MASK, OCTET_MIN, OCTET_MAX&quot;

$GATEWAY_OCTETS = &quot;{newOsNodeSubnet.gateway}&quot;.split(&#x27;.&#x27;)
$SUBNET_OCTETS = &quot;{newOsNodeSubnet.subnet}&quot;.split(&#x27;.&#x27;)
$NETMASK_OCTETS = &quot;{newOsNodeSubnet.netmask}&quot;.split(&#x27;.&#x27;)

for ($i = 0; $i -lt 4; $i++) {
    $GATEWAY_OCTET = $GATEWAY_OCTETS[$i]
    $SUBNET_OCTET = $SUBNET_OCTETS[$i]
    $NETMASK_OCTET = $NETMASK_OCTETS[$i]
    
    $OCTET_MIN = $SUBNET_OCTET -band $NETMASK_OCTET

    $WILDCARD_MASK = 255 - $NETMASK_OCTET
    $OCTET_MAX = $SUBNET_OCTET -bor $WILDCARD_MASK
    
    #Write-Host &quot;$i. $GATEWAY_OCTET, $SUBNET_OCTET, $NETMASK_OCTET, $WILDCARD_MASK, $OCTET_MIN, $OCTET_MAX&quot;
    
    if ( ($GATEWAY_OCTET -ge $OCTET_MIN) -and
        ($GATEWAY_OCTET -le $OCTET_MAX) ) {
        Write-Host &quot;Octet number $i, $OCTET_MIN &lt;= $GATEWAY_OCTET &lt;= $OCTET_MAX, ok.&quot;
    } else {
        Write-Host &quot;Octet number $i, $OCTET_MIN &lt;= $GATEWAY_OCTET &lt;= $OCTET_MAX is false. Not in range of the subnet mask.&quot;
        exit 1
    }
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="verifywslisinstalled">
                            <a href="#verifywslisinstalled">
                                <strong>Step 5 -</strong> Verify WSL is Installed
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Check if Windows Subsystem for Linux is installed.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
wsl --list

if (echo $?) {
    Write-Host &quot;WSL is installed.&quot;
} else {
    Write-Host &quot;WSL is not installed.&quot;
    exit 1
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="cleanupbuildfilesandisosonwindowsworker">
                            <a href="#cleanupbuildfilesandisosonwindowsworker">
                                <strong>Step 6 -</strong> Clean Up Build Files and ISOs on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$DIR=&quot;C:\attuneautomationworker\build-{newOsNode.fqn}&quot;

if (Test-Path $DIR) {
    Remove-Path -Recursive $DIR
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploywin10dvdisoonwindowsworker">
                            <a href="#deploywin10dvdisoonwindowsworker">
                                <strong>Step 7 -</strong> Deploy Win10 DVD ISO on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys Windows Desktop 10 ISO to <code>/c$/attuneautomationworker/build-{newOsNode.fqn}</code>.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>Download from https://www.microsoft.com/en-us/software-download/windows10ISO/.</p>
<p>Please select the English (United States) version.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Win10_Desktop_ISO.tar</strong>
            to the target node.
        </p>
        <p>
            <strong>Deploy the File(s)</strong> here:
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
/c$/attuneautomationworker/build-{newOsNode.fqn}
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="extractwindowsbootimgonwindowsworker">
                            <a href="#extractwindowsbootimgonwindowsworker">
                                <strong>Step 8 -</strong> Extract Windows boot.img on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Extracts the <code>boot.img</code> from the ISO. This is required for passing to <code>mkisofs</code> to regenerate a bootable BIOS ISO.</p>
<p>Only applies BIOS kickstarts so if any of these parameters are set the string <code>true</code>:</p>
<ol>
<li>isWin10Bios</li>
<li>isWinServerBios</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if ((${{isWin10Bios}}) -or `
    (${{isWinServerBios}})) {

  $ISO_BUILD=&quot;C:\attuneautomationworker&quot;
  $BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;


  Set-Location $BUILD_DIR

  $scriptContent=@&#x27;
# Case insensitve globbing
shopt -s nocaseglob;
# Set the filename of the ISO
F=$(ls *.iso);
# Get the Boot image offset
OFFSET=`isoinfo -d -i $F | grep Bootoff | cut  -c21-`;
# Extract the boot.img.
dd if=$F of=boot.img bs=2048 count=8 skip=$OFFSET;
&#x27;@

  $FILE = &quot;tmpBash.sh&quot;

  Set-Content -Path $FILE -NoNewline -Value $scriptContent

  wsl -d Ubuntu --user {wsl2AutomationWorkerLinuxUser.user} --exec bash &quot;${FILE}&quot;

  if ($LASTEXITCODE -ne 0) {
    Write-Error &#x27;Failed to extract boot.img&#x27;
  }
  
  Remove-Item &quot;${FILE}&quot;

} else {
    Write-Host &quot;Skipping for UEFI ISO creation.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="extractwindowsisoonwindowsworker">
                            <a href="#extractwindowsisoonwindowsworker">
                                <strong>Step 9 -</strong>  Extract Windows ISO on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ISO_BUILD=&quot;C:\attuneautomationworker&quot;
$BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

Set-Location $BUILD_DIR

$command = &quot;wsl -d debian --exec &quot;

# Case insensitve globbing
$command += &#x27; shopt -s nocaseglob;&#x27; 

# Set the filename of the ISO
$command += `
&#x27;if ls | grep -q *iso
 then
     
     ISO=&quot;$(echo *iso)&quot;
     echo &quot;ISO is $ISO&quot;
     
     7z x &quot;${ISO}&quot;
     
     rm -v &quot;${ISO}&quot;
 else
     echo &quot;ISO is already extracted.&quot;
 fi&#x27;

&amp; cmd /c &quot;$command&quot;
if ($LASTEXITCODE -ne 0) {
  Write-Error &#x27;Failed to extract ISO&#x27;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="copyefisysnopromptbinintoefisysbinonwindowsworker">
                            <a href="#copyefisysnopromptbinintoefisysbinonwindowsworker">
                                <strong>Step 10 -</strong> Copy efisys_noprompt.bin into efisys.bin on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p><code>efisys_noprompt.bin</code> does not have the prompt "Pres any key to boot from CDROM".</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if ( ${{isWin10Uefi}} -or ${{isWinServerUefi}} ) {

    $ISO_BUILD=&quot;C:\attuneautomationworker&quot;
    $BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

    Set-Location $BUILD_DIR

    Set-Location efi/microsoft/boot/
    
    Copy-Item -Path .\efisys_noprompt.bin -Destination .\efisys.bin
} else {
    Write-Host &quot;Skipping for BIOS ISO creation.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="createbiosbootisoonwindowsworker">
                            <a href="#createbiosbootisoonwindowsworker">
                                <strong>Step 11 -</strong> Create BIOS Boot ISO on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a BIOS bootable Windows ISO called <code>kickstart_{newOsNode.fqn}.iso</code> from the contents in folder <code>C:\attuneautomationworker\build-{newOsNode.fqn}</code>.</p>
<p>Only applies BIOS kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Bios</li>
<li>isWinServerBios</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ISO_BUILD=&quot;C:\attuneautomationworker&quot;
$BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

Set-Location $BUILD_DIR

if (${{isWin10Bios}} -or `
    ${{isWinServerBios}}) {

  $command = &quot;wsl -d debian --exec &quot;
  $command += &#x27; xorriso -as mkisofs \ 
            -b boot.img \
            -no-emul-boot \
            -c BOOT.CAT \
            -iso-level 3 \
            -udf \
            -joliet-long \
            -relaxed-filenames \
            -allow-limited-size \
            -J \
            -full-iso9660-filenames \
            -disable-deep-relocation \
            -omit-version-number \
            -V &quot;KS_WIN&quot; \
            -o C:\attuneautomationworker/kickstart_{newOsNode.fqn}.iso \
            .&#x27;

  &amp; cmd /c &quot;$command&quot;
  if ($LASTEXITCODE -ne 0) {
    Write-Error &#x27;Failed to create ISO&#x27;
  }

} else {
    Write-Host &quot;Skipping for UEFI boot.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="createuefibootisoonwindowsworker">
                            <a href="#createuefibootisoonwindowsworker">
                                <strong>Step 12 -</strong> Create UEFI Boot ISO on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a UEFI bootable Windows ISO called <code>kickstart_{newOsNode.fqn}.iso</code> from the contents in folder <code>C:\attuneautomationworker\build-{newOsNode.fqn}</code>.</p>
<p>Only applies BIOS kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Uefi</li>
<li>isWinServerUefi</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ISO_BUILD=&quot;C:\attuneautomationworker&quot;
$BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

Set-Location $BUILD_DIR

if (${{isWin10Uefi}} -or `
    ${{isWinServerUefi}}) {

  $command = &quot;wsl -d debian --exec &quot;
  $command += &#x27; xorriso -as mkisofs \ 
            -allow-limited-size \
            -iso-level 4 \
            -full-iso9660-filenames \
            -rock \
            -b boot/etfsboot.com \
            -no-emul-boot \
            -boot-load-seg 0 \
            -boot-load-size 8 \
            -hide boot.catalog \
            -eltorito-alt-boot \
            -no-emul-boot \
            -b efi/microsoft/boot/efisys.bin \
            -boot-load-size 1 \
            -udf \
            -untranslated-filenames \
            -disable-deep-relocation \
            -o C:\attuneautomationworker/kickstart_{newOsNode.fqn}.iso \
            .&#x27;

  &amp; cmd /c &quot;$command&quot;
  if ($LASTEXITCODE -ne 0) {
    Write-Error &#x27;Failed to create ISO&#x27;
  }

} else {
    Write-Host &quot;Skipping for BIOS boot.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploywindowsunattendedconfigonwindowsworker">
                            <a href="#deploywindowsunattendedconfigonwindowsworker">
                                <strong>Step 13 -</strong> Deploy Windows Unattended Config on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>For these Windows versions:
* WIndows Desktop 10
* WIndows Server 2016
* WIndows Server 2019
* WIndows Server 2022</p>
<p>For these boot methods:
* BIOS
* UEFI</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Windows_Unattended_config.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
/c$/attuneautomationworker/build-{newOsNode.fqn}
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploypostsetuppowershellscriptonwindowsworker">
                            <a href="#deploypostsetuppowershellscriptonwindowsworker">
                                <strong>Step 14 -</strong> Deploy Post Setup PowerShell Script on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>This file is called by the "<FirstLogonCommands>" section in the autounattend.xml file.</p>
<p>This script is run once post installation of the WIndows operating system.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Post_Install_Setup_PowerShell_Script.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
/c$/attuneautomationworker/build-{newOsNode.fqn}
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="copydriversdropinfolderonwindowsworker">
                            <a href="#copydriversdropinfolderonwindowsworker">
                                <strong>Step 15 -</strong> Copy Drivers Drop in Folder on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ISO_BUILD=&quot;C:\attuneautomationworker&quot;
$BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

Set-Location $BUILD_DIR

$DRIVERS_DROP_IN_FOLDER = &quot;C:\attuneautomationworker\drivers-{newOsNode.fqn}&quot;
$DESTINATION_DRIVERS_FOLDER = &quot;drivers&quot;

New-Item $DESTINATION_DRIVERS_FOLDER -ItemType Directory

if ( Test-Path &quot;${DRIVERS_DROP_IN_FOLDER}&quot; ) {

    Copy-Item -Path -Recurse &quot;${DRIVERS_DROP_IN_FOLDER}&quot; `
        -Destination &quot;${DESTINATION_DRIVERS_FOLDER}&quot;
} else {
    Write-Host &quot;Drivers drop in folder ${DRIVERS_DROP_IN_FOLDER} does not exist. No drivers copied.&quot;
}
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="createanswerfileisoonwindowsworker">
                            <a href="#createanswerfileisoonwindowsworker">
                                <strong>Step 16 -</strong> Create Answer File ISO on Windows Worker
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ISO_BUILD=&quot;C:\attuneautomationworker&quot;
$BUILD_DIR=&quot;$ISO_BUILD\build-{newOsNode.fqn}&quot;

Set-Location $BUILD_DIR

$DRIVERS_FOLDER=&quot;drivers&quot;
$DRIVERS_ISO_NAME=&quot;drivers_{newOsNode.fqn}.iso&quot;

$command = &quot;wsl -d debian --exec &quot;
$command += &#x27; xorriso -as mkisofs \
        -o ../${DRIVERS_ISO_NAME} \
        -iso-level 3 -udf -joliet-long -relaxed-filenames \
        -J -l -D -N -V &quot;DRIVERS&quot; &quot;${DRIVERS_FOLDER}&quot; \
        autounattend.xml post_install_setup.ps1&#x27;
        
&amp; cmd /c &quot;$command&quot;
if ($LASTEXITCODE -ne 0) {
    Write-Error &#x27;Failed to create ISO&#x27;
}
                </code>
            </pre>
        </div>
    </div>






                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
